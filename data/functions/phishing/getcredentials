function getcredentials {
    param(
      [Parameter(Mandatory)]
      [String] $title,
      [Parameter(Mandatory)]
      [String] $message,
      [Parameter(Mandatory=$false)]
      [String] $domain
    )

    if (-not $domain) { $domain = "" }
    $credential = $host.ui.PromptForCredential($title, $message, "", $domain)
    $path = ($pwd.Path+"\cred.xml")
    $credential | Export-Clixml -Path $path
    printMessage -message "Credentials saved in $path"
    # To Import
    # $credential = Import-Clixml -Path ($pwd.Path+"\cred.xml")
}